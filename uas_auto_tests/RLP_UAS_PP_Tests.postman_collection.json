{
	"info": {
		"_postman_id": "14e1a403-e146-4b05-9377-0a0bee8e36e2",
		"name": "UAS_Integration_Tests",
		"description": "UAS integration tests for the new user agreeement service.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "OAuth Get Token ",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "25e80c94-9f9a-4dca-adfd-4065fc7e86d9",
						"exec": [
							"var data = JSON.parse(responseBody);",
							"console.log(\"Partner 1 token: bearer \" + data.access_token);",
							"pm.environment.set(\"token\", data.access_token);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "authorization",
						"value": "Basic {{basic_auth_token}}",
						"type": "text"
					},
					{
						"key": "cache-control",
						"value": "no-cache",
						"type": "text"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/x-www-form-urlencoded",
						"type": "text"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "username",
							"value": "psahayaraj@opentable.com",
							"type": "text"
						},
						{
							"key": "password",
							"value": "Placements@123456789",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{oauth_host}}/api/v2/oauth/token",
					"host": [
						"{{oauth_host}}"
					],
					"path": [
						"api",
						"v2",
						"oauth",
						"token"
					]
				},
				"description": "OAuth Get Token "
			},
			"response": []
		},
		{
			"name": "Create a new user agreement for context and agreement type",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "1e1bc953-8af3-49b2-bcb0-9727e58b87b0",
						"exec": [
							"var data = JSON.parse(responseBody);",
							"console.log(\"The agreement id is :\" + data.id);",
							"",
							"//get the agreement type, signing details and terms and conditions for agreement",
							"var agreementType = data.type;",
							"var signedDetails = data.signingDetails;",
							"var termsAndConditions = data.termsAndConditions;",
							"",
							"if(responseCode.code !== 201){",
							"    console.log(\"Failed with the following error:\" + data.errorCode);",
							"    console.log(\"error status: \" + responseCode.Code);",
							"}",
							"else{",
							"",
							"//success scenario: verify status code is 200",
							"pm.test(\"Verify status code indicates success\", function () {",
							"    pm.expect(pm.response.code).to.eql(201);",
							"});",
							"",
							"//verify agreement id exists in response ",
							"pm.test(\"Verify agreement has agreement id\", function () {",
							"    pm.expect(data).to.have.property('id');",
							"    pm.expect(data.id).not.equal(null);",
							"});",
							"",
							"//Verify agreement type exist in response and is not null",
							"pm.test(\"Verify agreement has agreement type\", function () {",
							"    pm.expect(data).to.have.property('type');",
							"    pm.expect(data.type).not.equal(null);",
							"});",
							"",
							"//Verify the name of the agreement type exists in response and is not null",
							"pm.test(\"Verify agreement has agreement type name\", function () {",
							"    pm.expect(agreementType).to.have.property('name');",
							"    pm.expect(agreementType.name).not.equal(null);",
							"});",
							"",
							"//Verify the name of the agreement type intent text id is in response and is not null",
							"pm.test(\"Verify agreement has agreement type intent text id\", function () {",
							"    pm.expect(agreementType).to.have.property('intentTextId');",
							"    pm.expect(agreementType.intentTextId).not.equal(null);",
							"});",
							" ",
							"//Verify the context exists in the response and is not null",
							"pm.test(\"Verify agreement has context\", function () {",
							"    pm.expect(data).to.have.property('context');",
							"    pm.expect(data.context).not.equal(null);",
							"});",
							"",
							"//Verify the locale exists in the response and is not null",
							"pm.test(\"Verify agreement has locale\", function () {",
							"    pm.expect(data).to.have.property('locale');",
							"    pm.expect(data.locale).not.equal(null);",
							"});",
							"",
							"//Verify the assignedUser does not exist in the response and is not null",
							"pm.test(\"Verify agreement does not have assignedUser\", function () {",
							"    pm.expect(data).to.have.property('assignedUser');",
							"    pm.expect(data.assignedUser).to.equal(null);",
							"});",
							"",
							"//Verify the legalEntity exists in the response and is not null",
							"pm.test(\"Verify agreement has legalEntity\", function () {",
							"    pm.expect(data).to.have.property('legalEntity');",
							"    pm.expect(data.legalEntity).not.equal(null);",
							"});",
							"",
							"//Verify the createdDateUTC exists in the response and is not null",
							"pm.test(\"Verify agreement has createdDateUTC\", function () {",
							"    pm.expect(data).to.have.property('createdDateUTC');",
							"    pm.expect(data.createdDateUTC).not.equal(null);",
							"});",
							"",
							"//Verify the lastUpdatedDataUTC exists in the response and is not null",
							"pm.test(\"Verify agreement has lastUpdatedDataUTC\", function () {",
							"    pm.expect(data).to.have.property('lastUpdatedDataUTC');",
							"    pm.expect(data.lastUpdatedDataUTC).not.equal(null);",
							"});",
							"",
							"//Verify the state exists in the response and is not null",
							"pm.test(\"Verify agreement has state\", function () {",
							"    pm.expect(data).to.have.property('state');",
							"    pm.expect(data.state).not.equal(null);",
							"});",
							"",
							"//Verify the signing details is null (not yet signed) in response",
							"pm.test(\"Verify that the agreement is not yet signed\", function (){",
							"    pm.expect(data).to.have.property('signingDetails');",
							"    pm.expect(data.signingDetails).to.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions exist in the response",
							"pm.test(\"Verify that the agreement has terms and conditions \", function (){",
							"    pm.expect(data).to.have.property('termsAndConditions');",
							"    pm.expect(data.termsAndConditions).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has version in response",
							"pm.test(\"Verify the terms and conditions has version in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('version');",
							"    pm.expect(termsAndConditions[0].version).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has terms id in response",
							"pm.test(\"Verify the terms and conditions has termsId in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('termsId');",
							"    pm.expect(termsAndConditions[0].termsId).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has content in response",
							"pm.test(\"Verify the terms and conditions has content in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('content');",
							"    pm.expect(termsAndConditions[0].content).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has title in response",
							"pm.test(\"Verify the terms and conditions has title in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('title');",
							"    pm.expect(termsAndConditions[0].title).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has locale in response",
							"pm.test(\"Verify the terms and conditions has locale in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('locale');",
							"    pm.expect(termsAndConditions[0].locale).not.equal(null);",
							"});",
							"",
							"pm.environment.set(\"agreementId\", data.id);",
							"}"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"type": "text",
						"value": "Bearer {{token}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n \"type\":\"pos_integration\",\n \"context\":\"urn:ot.restaurants:1005730\"\n}"
				},
				"url": {
					"raw": "{{uas_host}}/v1/user-agreement/agreements",
					"host": [
						"{{uas_host}}"
					],
					"path": [
						"v1",
						"user-agreement",
						"agreements"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get AgreementDetails Before Signing",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "249b3bcb-6a00-4bf0-8e0a-ff3ad26befdc",
						"exec": [
							"var data = JSON.parse(responseBody);",
							"console.log(\"The agreement id is :\" + data.id);",
							"",
							"//get the agreement type, signing details and terms and conditions for agreement",
							"var agreementType = data.type;",
							"var signedDetails = data.signingDetails;",
							"var termsAndConditions = data.termsAndConditions;",
							"",
							"//error scenario",
							"if(responseCode.code !== 200){",
							"    console.log(\"Failed with the following error:\" + data.errorCode);",
							"    console.log(\"error status: \" + responseCode.Code);",
							"}",
							"",
							"else{",
							"//success scenario: verify status code is 200",
							"pm.test(\"Verify status code indicates success\", function () {",
							"    pm.expect(pm.response.code).to.eql(200);",
							"});",
							"",
							"//verify agreement id exists in response ",
							"pm.test(\"Verify agreement has agreement id\", function () {",
							"    pm.expect(data).to.have.property('id');",
							"    pm.expect(data.id).not.equal(null);",
							"});",
							"",
							"//Verify agreement type exist in response and is not null",
							"pm.test(\"Verify agreement has agreement type\", function () {",
							"    pm.expect(data).to.have.property('type');",
							"    pm.expect(data.type).not.equal(null);",
							"});",
							"",
							"//Verify the name of the agreement type exists in response and is not null",
							"pm.test(\"Verify agreement has agreement type name\", function () {",
							"    pm.expect(agreementType).to.have.property('name');",
							"    pm.expect(agreementType.name).not.equal(null);",
							"});",
							"",
							"//Verify the name of the agreement type intent text id is in response and is not null",
							"pm.test(\"Verify agreement has agreement type intent text id\", function () {",
							"    pm.expect(agreementType).to.have.property('intentTextId');",
							"    pm.expect(agreementType.intentTextId).not.equal(null);",
							"});",
							" ",
							"//Verify the context exists in the response and is not null",
							"pm.test(\"Verify agreement has context\", function () {",
							"    pm.expect(data).to.have.property('context');",
							"    pm.expect(data.context).not.equal(null);",
							"});",
							"",
							"//Verify the locale exists in the response and is not null",
							"pm.test(\"Verify agreement has locale\", function () {",
							"    pm.expect(data).to.have.property('locale');",
							"    pm.expect(data.locale).not.equal(null);",
							"});",
							"",
							"//Verify the assignedUser does not exist in the response and is not null",
							"pm.test(\"Verify agreement does not have assignedUser\", function () {",
							"    pm.expect(data).to.have.property('assignedUser');",
							"    pm.expect(data.assignedUser).to.equal(null);",
							"});",
							"",
							"//Verify the legalEntity exists in the response and is not null",
							"pm.test(\"Verify agreement has legalEntity\", function () {",
							"    pm.expect(data).to.have.property('legalEntity');",
							"    pm.expect(data.legalEntity).not.equal(null);",
							"});",
							"",
							"//Verify the createdDateUTC exists in the response and is not null",
							"pm.test(\"Verify agreement has createdDateUTC\", function () {",
							"    pm.expect(data).to.have.property('createdDateUTC');",
							"    pm.expect(data.createdDateUTC).not.equal(null);",
							"});",
							"",
							"//Verify the lastUpdatedDataUTC exists in the response and is not null",
							"pm.test(\"Verify agreement has lastUpdatedDataUTC\", function () {",
							"    pm.expect(data).to.have.property('lastUpdatedDataUTC');",
							"    pm.expect(data.lastUpdatedDataUTC).not.equal(null);",
							"});",
							"",
							"//Verify the state exists in the response and is not null",
							"pm.test(\"Verify agreement has state\", function () {",
							"    pm.expect(data).to.have.property('state');",
							"    pm.expect(data.state).not.equal(null);",
							"});",
							"",
							"//Verify the signing details is null (not yet signed) in response",
							"pm.test(\"Verify that the agreement is not yet signed\", function (){",
							"    pm.expect(data).to.have.property('signingDetails');",
							"    pm.expect(data.signingDetails).to.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions exist in the response",
							"pm.test(\"Verify that the agreement has terms and conditions \", function (){",
							"    pm.expect(data).to.have.property('termsAndConditions');",
							"    pm.expect(data.termsAndConditions).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has version in response",
							"pm.test(\"Verify the terms and conditions has version in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('version');",
							"    pm.expect(termsAndConditions[0].version).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has terms id in response",
							"pm.test(\"Verify the terms and conditions has termsId in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('termsId');",
							"    pm.expect(termsAndConditions[0].termsId).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has content in response",
							"pm.test(\"Verify the terms and conditions has content in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('content');",
							"    pm.expect(termsAndConditions[0].content).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has title in response",
							"pm.test(\"Verify the terms and conditions has title in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('title');",
							"    pm.expect(termsAndConditions[0].title).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has locale in response",
							"pm.test(\"Verify the terms and conditions has locale in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('locale');",
							"    pm.expect(termsAndConditions[0].locale).to.not.equal(null);",
							"});",
							"",
							"}",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{token}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{uas_host}}/v1/user-agreement/agreements/{{agreementId}}",
					"host": [
						"{{uas_host}}"
					],
					"path": [
						"v1",
						"user-agreement",
						"agreements",
						"{{agreementId}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Sign User Agreement",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "a029d532-8fce-438b-a338-fd9b1ba04e96",
						"exec": [
							"var data = JSON.parse(responseBody);",
							"console.log(\"The agreement id is :\" + data.id);",
							"",
							"//get the agreement type, signing details and terms and conditions for agreement",
							"var agreementType = data.type;",
							"var signedDetails = data.signingDetails;",
							"var termsAndConditions = data.termsAndConditions;",
							"",
							"if(responseCode.code !== 200){",
							"    console.log(\"Failed with the following error:\" + data.errorCode);",
							"    console.log(\"error status: \" + responseCode.Code);",
							"}",
							"else{",
							"",
							"//success scenario: verify status code is 200",
							"pm.test(\"Verify status code indicates success\", function () {",
							"    pm.expect(pm.response.code).to.eql(200);",
							"});",
							"",
							"//verify agreement id exists in response ",
							"pm.test(\"Verify agreement has agreement id\", function () {",
							"    pm.expect(data).to.have.property('id');",
							"    pm.expect(data.id).not.equal(null);",
							"});",
							"",
							"//Verify agreement type exist in response and is not null",
							"pm.test(\"Verify agreement has agreement type\", function () {",
							"    pm.expect(data).to.have.property('type');",
							"    pm.expect(data.type).not.equal(null);",
							"});",
							"",
							"//Verify the name of the agreement type exists in response and is not null",
							"pm.test(\"Verify agreement has agreement type name\", function () {",
							"    pm.expect(agreementType).to.have.property('name');",
							"    pm.expect(agreementType.name).not.equal(null);",
							"});",
							"",
							"//Verify the name of the agreement type intent text id is in response and is not null",
							"pm.test(\"Verify agreement has agreement type intent text id\", function () {",
							"    pm.expect(agreementType).to.have.property('intentTextId');",
							"    pm.expect(agreementType.intentTextId).not.equal(null);",
							"});",
							" ",
							"//Verify the context exists in the response and is not null",
							"pm.test(\"Verify agreement has context\", function () {",
							"    pm.expect(data).to.have.property('context');",
							"    pm.expect(data.context).not.equal(null);",
							"});",
							"",
							"//Verify the locale exists in the response and is not null",
							"pm.test(\"Verify agreement has locale\", function () {",
							"    pm.expect(data).to.have.property('locale');",
							"    pm.expect(data.locale).not.equal(null);",
							"});",
							"",
							"//Verify the assignedUser does not exist in the response and is not null",
							"pm.test(\"Verify agreement does not have assignedUser\", function () {",
							"    pm.expect(data).to.have.property('assignedUser');",
							"    pm.expect(data.assignedUser).not.equal(null);",
							"});",
							"",
							"//Verify the legalEntity exists in the response and is not null",
							"pm.test(\"Verify agreement has legalEntity\", function () {",
							"    pm.expect(data).to.have.property('legalEntity');",
							"    pm.expect(data.legalEntity).not.equal(null);",
							"});",
							"",
							"//Verify the createdDateUTC exists in the response and is not null",
							"pm.test(\"Verify agreement has createdDateUTC\", function () {",
							"    pm.expect(data).to.have.property('createdDateUTC');",
							"    pm.expect(data.createdDateUTC).not.equal(null);",
							"});",
							"",
							"//Verify the lastUpdatedDataUTC exists in the response and is not null",
							"pm.test(\"Verify agreement has lastUpdatedDataUTC\", function () {",
							"    pm.expect(data).to.have.property('lastUpdatedDataUTC');",
							"    pm.expect(data.lastUpdatedDataUTC).not.equal(null);",
							"});",
							"",
							"//Verify the state exists in the response and is not null",
							"pm.test(\"Verify agreement has state\", function () {",
							"    pm.expect(data).to.have.property('state');",
							"    pm.expect(data.state).not.equal(null);",
							"});",
							"",
							"//Verify the signing details is null (not yet signed) in response",
							"pm.test(\"Verify that the agreement is not yet signed\", function (){",
							"    pm.expect(data).to.have.property('signingDetails');",
							"    pm.expect(data.signingDetails).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions exist in the response",
							"pm.test(\"Verify that the agreement has terms and conditions \", function (){",
							"    pm.expect(data).to.have.property('termsAndConditions');",
							"    pm.expect(data.termsAndConditions).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has version in response",
							"pm.test(\"Verify the terms and conditions has version in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('version');",
							"    pm.expect(termsAndConditions[0].version).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has terms id in response",
							"pm.test(\"Verify the terms and conditions has termsId in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('termsId');",
							"    pm.expect(termsAndConditions[0].termsId).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has content in response",
							"pm.test(\"Verify the terms and conditions has content in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('content');",
							"    pm.expect(termsAndConditions[0].content).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has title in response",
							"pm.test(\"Verify the terms and conditions has title in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('title');",
							"    pm.expect(termsAndConditions[0].title).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has locale in response",
							"pm.test(\"Verify the terms and conditions has locale in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('locale');",
							"    pm.expect(termsAndConditions[0].locale).to.not.equal(null);",
							"});",
							"",
							"//Verify the signing details exist in the response",
							"pm.test(\"Verify that the agreement is signed\", function (){",
							"    pm.expect(signedDetails).to.not.eql(null);",
							"    pm.expect(data.signingDetails).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has userEmail in the response",
							"pm.test(\"Verify that the agreement has userEmail\", function (){",
							"    pm.expect(signedDetails).to.have.property('userEmail');",
							"    pm.expect(signedDetails.userEmail).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has firstName in the response",
							"pm.test(\"Verify that the agreement has firstName\", function (){",
							"    pm.expect(signedDetails).to.have.property('firstName');",
							"    pm.expect(signedDetails.firstName).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has lastName in the response",
							"pm.test(\"Verify that the agreement has lastName\", function (){",
							"    pm.expect(signedDetails).to.have.property('lastName');",
							"    pm.expect(signedDetails.lastName).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has title in the response",
							"pm.test(\"Verify that the agreement has title \", function (){",
							"    pm.expect(signedDetails).to.have.property('title');",
							"    pm.expect(signedDetails.title).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has ipAddress in the response",
							"pm.test(\"Verify that the agreement has ipAddress \", function (){",
							"    pm.expect(signedDetails).to.have.property('ipAddress');",
							"    pm.expect(signedDetails.ipAddress).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has signedDate in the response",
							"pm.test(\"Verify that the agreement has signedDate \", function (){",
							"    pm.expect(signedDetails).to.have.property('signedDateUTC');",
							"    pm.expect(signedDetails.signedDateUTC).not.equal(null);",
							"});",
							"",
							"}",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{token}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\"termsId\":[1]\n}"
				},
				"url": {
					"raw": "{{uas_host}}/v1/user-agreement/agreements/{{agreementId}}/sign",
					"host": [
						"{{uas_host}}"
					],
					"path": [
						"v1",
						"user-agreement",
						"agreements",
						"{{agreementId}}",
						"sign"
					]
				}
			},
			"response": []
		},
		{
			"name": "Try to resign signed agreement",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "5a74de80-0562-4bff-ac86-78d584270845",
						"exec": [
							"var errorData = JSON.parse(responseBody);",
							"",
							"",
							"if(responseCode.code == 400){",
							"    ",
							"   pm.test(\"Verify error code for agreement already signed\", function () {",
							"    pm.expect(errorData.errorCode).to.eql(\"agreement_already_signed\");",
							"});",
							"",
							"   pm.test(\"Verify error description for agreement already signed\", function () {",
							"    pm.expect(errorData.description).to.eql(\"Agreement has already been signed\");",
							"});",
							"}"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{token}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\"termsId\":[2]\n}"
				},
				"url": {
					"raw": "{{uas_host}}/v1/user-agreement/agreements/{{agreementId}}/sign",
					"host": [
						"{{uas_host}}"
					],
					"path": [
						"v1",
						"user-agreement",
						"agreements",
						"{{agreementId}}",
						"sign"
					]
				},
				"description": "Error use case"
			},
			"response": []
		},
		{
			"name": "Get Signed Agreement",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "c08ba16b-6c89-4d60-a2d2-35fa97f383f4",
						"exec": [
							"var data = JSON.parse(responseBody);",
							"console.log(\"The agreement id is :\" + data.id);",
							"",
							"//get the agreement type, signing details and terms and conditions for agreement",
							"var agreementType = data.type;",
							"var signedDetails = data.signingDetails;",
							"var termsAndConditions = data.termsAndConditions;",
							"",
							"if(responseCode.code !== 200){",
							"    console.log(\"Failed with the following error:\" + data.errorCode);",
							"    console.log(\"error status: \" + responseCode.Code);",
							"}",
							"else{",
							"",
							"//success scenario: verify status code is 200",
							"pm.test(\"Verify status code indicates success\", function () {",
							"    pm.expect(pm.response.code).to.eql(200);",
							"});",
							"",
							"//verify agreement id exists in response ",
							"pm.test(\"Verify agreement has agreement id\", function () {",
							"    pm.expect(data).to.have.property('id');",
							"    pm.expect(data.id).not.equal(null);",
							"});",
							"",
							"//Verify agreement type exist in response and is not null",
							"pm.test(\"Verify agreement has agreement type\", function () {",
							"    pm.expect(data).to.have.property('type');",
							"    pm.expect(data.type).not.equal(null);",
							"});",
							"",
							"//Verify the name of the agreement type exists in response and is not null",
							"pm.test(\"Verify agreement has agreement type name\", function () {",
							"    pm.expect(agreementType).to.have.property('name');",
							"    pm.expect(agreementType.name).not.equal(null);",
							"});",
							"",
							"//Verify the name of the agreement type intent text id is in response and is not null",
							"pm.test(\"Verify agreement has agreement type intent text id\", function () {",
							"    pm.expect(agreementType).to.have.property('intentTextId');",
							"    pm.expect(agreementType.intentTextId).not.equal(null);",
							"});",
							" ",
							"//Verify the context exists in the response and is not null",
							"pm.test(\"Verify agreement has context\", function () {",
							"    pm.expect(data).to.have.property('context');",
							"    pm.expect(data.context).not.equal(null);",
							"});",
							"",
							"//Verify the locale exists in the response and is not null",
							"pm.test(\"Verify agreement has locale\", function () {",
							"    pm.expect(data).to.have.property('locale');",
							"    pm.expect(data.locale).not.equal(null);",
							"});",
							"",
							"//Verify the assignedUser does not exist in the response and is not null",
							"pm.test(\"Verify agreement does not have assignedUser\", function () {",
							"    pm.expect(data).to.have.property('assignedUser');",
							"    pm.expect(data.assignedUser).not.equal(null);",
							"});",
							"",
							"//Verify the legalEntity exists in the response and is not null",
							"pm.test(\"Verify agreement has legalEntity\", function () {",
							"    pm.expect(data).to.have.property('legalEntity');",
							"    pm.expect(data.legalEntity).not.equal(null);",
							"});",
							"",
							"//Verify the createdDateUTC exists in the response and is not null",
							"pm.test(\"Verify agreement has createdDateUTC\", function () {",
							"    pm.expect(data).to.have.property('createdDateUTC');",
							"    pm.expect(data.createdDateUTC).not.equal(null);",
							"});",
							"",
							"//Verify the lastUpdatedDataUTC exists in the response and is not null",
							"pm.test(\"Verify agreement has lastUpdatedDataUTC\", function () {",
							"    pm.expect(data).to.have.property('lastUpdatedDataUTC');",
							"    pm.expect(data.lastUpdatedDataUTC).not.equal(null);",
							"});",
							"",
							"//Verify the state exists in the response and is not null",
							"pm.test(\"Verify agreement has state\", function () {",
							"    pm.expect(data).to.have.property('state');",
							"    pm.expect(data.state).not.equal(null);",
							"});",
							"",
							"//Verify the signing details is null (not yet signed) in response",
							"pm.test(\"Verify that the agreement is not yet signed\", function (){",
							"    pm.expect(data).to.have.property('signingDetails');",
							"    pm.expect(data.signingDetails).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions exist in the response",
							"pm.test(\"Verify that the agreement has terms and conditions \", function (){",
							"    pm.expect(data).to.have.property('termsAndConditions');",
							"    pm.expect(data.termsAndConditions).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has version in response",
							"pm.test(\"Verify the terms and conditions has version in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('version');",
							"    pm.expect(termsAndConditions[0].version).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has terms id in response",
							"pm.test(\"Verify the terms and conditions has termsId in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('termsId');",
							"    pm.expect(termsAndConditions[0].termsId).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has content in response",
							"pm.test(\"Verify the terms and conditions has content in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('content');",
							"    pm.expect(termsAndConditions[0].content).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has title in response",
							"pm.test(\"Verify the terms and conditions has title in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('title');",
							"    pm.expect(termsAndConditions[0].title).not.equal(null);",
							"});",
							"",
							"//Verify the terms and conditions has locale in response",
							"pm.test(\"Verify the terms and conditions has locale in response \", function (){",
							"    pm.expect(termsAndConditions[0]).to.have.property('locale');",
							"    pm.expect(termsAndConditions[0].locale).to.not.equal(null);",
							"});",
							"",
							"//Verify the signing details exist in the response",
							"pm.test(\"Verify that the agreement is signed\", function (){",
							"    pm.expect(signedDetails).to.not.eql(null);",
							"    pm.expect(data.signingDetails).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has userEmail in the response",
							"pm.test(\"Verify that the agreement has userEmail\", function (){",
							"    pm.expect(signedDetails).to.have.property('userEmail');",
							"    pm.expect(signedDetails.userEmail).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has firstName in the response",
							"pm.test(\"Verify that the agreement has firstName\", function (){",
							"    pm.expect(signedDetails).to.have.property('firstName');",
							"    pm.expect(signedDetails.firstName).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has lastName in the response",
							"pm.test(\"Verify that the agreement has lastName\", function (){",
							"    pm.expect(signedDetails).to.have.property('lastName');",
							"    pm.expect(signedDetails.lastName).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has title in the response",
							"pm.test(\"Verify that the agreement has title \", function (){",
							"    pm.expect(signedDetails).to.have.property('title');",
							"    pm.expect(signedDetails.title).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has ipAddress in the response",
							"pm.test(\"Verify that the agreement has ipAddress \", function (){",
							"    pm.expect(signedDetails).to.have.property('ipAddress');",
							"    pm.expect(signedDetails.ipAddress).not.equal(null);",
							"});",
							"",
							"//Verify the signing details has signedDate in the response",
							"pm.test(\"Verify that the agreement has signedDate \", function (){",
							"    pm.expect(signedDetails).to.have.property('signedDateUTC');",
							"    pm.expect(signedDetails.signedDateUTC).not.equal(null);",
							"});",
							"",
							"",
							"}",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{token}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{uas_host}}/v1/user-agreement/agreements/{{agreementId}}",
					"host": [
						"{{uas_host}}"
					],
					"path": [
						"v1",
						"user-agreement",
						"agreements",
						"{{agreementId}}"
					]
				},
				"description": "Signed agreement should have signing details"
			},
			"response": []
		},
		{
			"name": "Sign User Agreement without terms id",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "2503ea88-9bc9-49e7-a289-811165b98b88",
						"exec": [
							"var errorData = JSON.parse(responseBody);",
							"",
							"if(responseCode.code == 400){",
							"    ",
							"   pm.test(\"Verify error for sign agreement with no terms id \", function () {",
							"    pm.expect(errorData.error).to.eql(\"Bad Request\");",
							"});",
							"",
							"   pm.test(\"Verify message for sign agreement with no terms id \", function () {",
							"    pm.expect(errorData.message).to.eql(\"Bad Request\");",
							"});",
							"",
							"  pm.test(\"Verify status for sign agreement with no terms id \", function () {",
							"    pm.expect(errorData.status).to.eql(400);",
							"});",
							"",
							"",
							"}"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{token}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{uas_host}}/v1/user-agreement/agreements/{{agreementId}}/sign",
					"host": [
						"{{uas_host}}"
					],
					"path": [
						"v1",
						"user-agreement",
						"agreements",
						"{{agreementId}}",
						"sign"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create User agreement with invalid agreement type",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "69e20807-3377-43ea-8638-7ca02d5629e3",
						"exec": [
							"var errorData = JSON.parse(responseBody);",
							"",
							"if(responseCode.code == 400){",
							"    ",
							"   pm.test(\"Verify error code for create agreement with invalid agreement type  \", function () {",
							"    pm.expect(errorData.errorCode).to.eql(\"invalid_agreement_type\");",
							"});",
							"",
							"   pm.test(\"Verify error description for create agreement with invalid agreement type  \", function () {",
							"    pm.expect(errorData.description).to.eql(\"agreement type not supported\");",
							"});",
							"",
							"}"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{token}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n \"type\":\"invalid_agreement_type\",\n \"context\":\"urn:ot.restaurants:1005730\"\n}"
				},
				"url": {
					"raw": "{{uas_host}}/v1/user-agreement/agreements",
					"host": [
						"{{uas_host}}"
					],
					"path": [
						"v1",
						"user-agreement",
						"agreements"
					]
				}
			},
			"response": []
		}
	]
}